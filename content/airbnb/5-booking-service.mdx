---
title: Booking Service
slug: /airbnb/booking-service
---

## 1. DB design

<img src="/airbnb/booking-service-db.png" style={{ width: 900 }} alt="crate.io" />

## 2. API design

- `POST /bookings`

```json
{
  "userId": 1,
  "roomId": 1,
  "quantity": 2,
  "startDate": "2012-09-21",
  "endDate": "2012-09-22"
}
```

## 3. Questions

- This design has no support for one customer booking different room types, tweak the design for that to be possible
- Statuses of a bookings:
  - `RESERVED`
  - `BOOKED`
  - `COMPLETED`
  - `CANCELLED`
- What contraints must be set on db level?
- Diagram flow of processing one booking?
  - What could be wrong along the way? Propose solution?
  - What to include in transaction? Should we include everything in transaction? Write pseudo-code?
  - How to handle race condition? when multiple users completing for last room?
- Think of optimizations over redis key expiring?
